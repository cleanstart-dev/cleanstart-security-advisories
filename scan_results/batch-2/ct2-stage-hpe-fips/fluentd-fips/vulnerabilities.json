{
  "SchemaVersion": 2,
  "CreatedAt": "2025-11-18T03:44:45.136716122Z",
  "ArtifactName": "us-central1-docker.pkg.dev/ct2-staging-build/staging-hpe-images/fluentd-fips:1.19.0-dev",
  "ArtifactType": "container_image",
  "Metadata": {
    "Size": 462972416,
    "OS": {
      "Family": "alpine",
      "Name": "3.20.7"
    },
    "ImageID": "sha256:7470220f10e11df3cb94ce6e44dd10c258ef4ae9c987a3c0f7c1c9d332468444",
    "DiffIDs": [
      "sha256:a012dff9c6da8776fb1167dc6ffbc441528837d8ae79492efbb3708a25f87a58",
      "sha256:b508e54efc3e660e8edaf5f9516f7a6716753cb0641393d2778aad4b12f83da4",
      "sha256:01b07146b35a0c3f5ae604860cb13b9aabae3cac057c189b6a5b17b55d7a9963",
      "sha256:3a7356e31d5b2bfad704fb18a675b0a473869682a04014ad7783152b25067cd6",
      "sha256:215292a875bb2fa642a9a3b411cf0f491913504a5df8657b45cf137c74efc30a",
      "sha256:daf0570f33ff19e58dc349c93591ffb0f8bdefcacde1273ef6d1522364468082",
      "sha256:a94680665b5451874cb9a688966a05387da52c8e7b358685191bbcee9f9c3f36",
      "sha256:cafd6f1470e6d3b16cd504c736338be4244c280e4737610ec57b48913ba0bc5c",
      "sha256:3bb89949c252e55f7ab6ca332d6cfefdff58e93f21962004bc50b943a70aa084"
    ],
    "RepoTags": [
      "us-central1-docker.pkg.dev/ct2-staging-build/staging-hpe-images/fluentd-fips:1.19.0-dev"
    ],
    "RepoDigests": [
      "us-central1-docker.pkg.dev/ct2-staging-build/staging-hpe-images/fluentd-fips@sha256:81091baaeafb2147898acead43d8604510b67c16cab7015584879ae08656c990"
    ],
    "ImageConfig": {
      "architecture": "amd64",
      "created": "2025-10-09T07:45:06.423432895Z",
      "history": [
        {
          "created": "2025-10-08T07:25:49Z",
          "comment": "Imported from -"
        },
        {
          "created": "2025-10-09T07:41:45Z",
          "created_by": "RUN /bin/sh -c addgroup -S clngroup \u0026\u0026     adduser -S -u 10000 clnstrt -G clngroup # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-10-09T07:42:23Z",
          "created_by": "RUN /bin/sh -c apk update \u0026\u0026 apk add --no-cache     glibc-clnstrt=2.41-r0     ruby-fluentd-1.19=1.19.0-r2     fluent-plugin-most     openssl=3.5.0-r0     libcrypto3=3.5.0-r0     libssl3=3.5.0-r0     openssl-dev=3.5.0-r0     clnstrt-dev-base-hpe # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-10-09T07:42:23Z",
          "created_by": "RUN /bin/sh -c apk upgrade # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-10-09T07:42:24Z",
          "created_by": "RUN /bin/sh -c rm -f /etc/ssl/openssl.cnf \u0026\u0026     apk add --force-overwrite openssl-provider-fips-hpe=3.0.16-r2 \u0026\u0026     rm -rf /usr/libexec/openssl-fips-provider 2\u003e/dev/null || true \u0026\u0026     OPENSSL_CONF=dne openssl fipsinstall -module /usr/lib/ossl-modules/fips.so -out /etc/ssl/fipsmodule.cnf \u0026\u0026     rm -rf /pkgdir/ \u0026\u0026     rm -rf /usr/include/openssl/ # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-10-09T07:42:25Z",
          "created_by": "RUN /bin/sh -c /usr/bin/fips_on # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-10-09T07:45:05Z",
          "created_by": "RUN /bin/sh -c printf \"https://clnpkgs.clnstrt.dev/main\" \u003e /etc/apk/repositories \u0026\u0026     printf \"https://clnpkgs.clnstrt.dev/community\" \u003e\u003e /etc/apk/repositories \u0026\u0026     printf \"https://clnpkgs.clnstrt.dev/triam\" \u003e\u003e /etc/apk/repositories \u0026\u0026     chown -R root:root /usr/lib /usr/bin \u0026\u0026     chmod -R 755 /usr/lib /usr/bin \u0026\u0026     find /usr/lib -type f -exec chmod 644 {} \\; \u0026\u0026     find /usr/lib -type d -exec chmod 755 {} \\; # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-10-09T07:45:05Z",
          "created_by": "RUN /bin/sh -c cp /etc/passwd /etc/passwd.bak \u0026\u0026     echo \"root:x:0:0:root:/root:/bin/sh\" \u003e /etc/passwd \u0026\u0026     echo \"clnstrt:x:10000:10000:clnstrt:/home/clnstrt:/bin/sh\" \u003e\u003e /etc/passwd \u0026\u0026     echo \"nobody:x:65534:65534:nobody:/:/sbin/nologin\" \u003e\u003e /etc/passwd \u0026\u0026     echo \"root:*:19000:0:72:7:35::\" \u003e /etc/shadow \u0026\u0026     echo \"clnstrt:*:19000:0:72:7:35::\" \u003e\u003e /etc/shadow \u0026\u0026     echo \"nobody:*:19000:0:72:7:35::\" \u003e\u003e /etc/shadow \u0026\u0026     chown root:root /etc/shadow \u0026\u0026     chmod 400 /etc/shadow # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-10-09T07:45:06Z",
          "created_by": "RUN /bin/sh -c ln -s /usr/lib/ruby/gems/3.3.0/bin/fluentd /usr/bin/fluentd \u0026\u0026     chmod 755 /usr/bin/fluentd \u0026\u0026     mkdir -p /var/log \u0026\u0026     chown -R clnstrt:clngroup /var/log # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-10-09T07:45:06Z",
          "created_by": "ENV FLUENTD_CONF=/etc/fluent/fluent.conf LD_PRELOAD= PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin SSL_CERT_FILE=/etc/ssl/certs/ca-certificates.crt",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-10-09T07:45:06Z",
          "created_by": "USER clnstrt",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-10-09T07:45:06Z",
          "created_by": "ENTRYPOINT [\"/usr/bin/fluentd\"]",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-10-09T07:45:06Z",
          "created_by": "LABEL org.opencontainers.image.authors=Cleanstart Team https://www.cleanstart.com/",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-10-09T07:45:06Z",
          "created_by": "LABEL org.opencontainers.image.vendor=Cleanstart",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-10-09T07:45:06Z",
          "created_by": "LABEL Cleanstart.main.package=ruby-fluentd-1.19",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-10-09T07:45:06Z",
          "created_by": "LABEL org.opencontainers.image.licenses=Apache-2.0",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        }
      ],
      "os": "linux",
      "rootfs": {
        "type": "layers",
        "diff_ids": [
          "sha256:a012dff9c6da8776fb1167dc6ffbc441528837d8ae79492efbb3708a25f87a58",
          "sha256:b508e54efc3e660e8edaf5f9516f7a6716753cb0641393d2778aad4b12f83da4",
          "sha256:01b07146b35a0c3f5ae604860cb13b9aabae3cac057c189b6a5b17b55d7a9963",
          "sha256:3a7356e31d5b2bfad704fb18a675b0a473869682a04014ad7783152b25067cd6",
          "sha256:215292a875bb2fa642a9a3b411cf0f491913504a5df8657b45cf137c74efc30a",
          "sha256:daf0570f33ff19e58dc349c93591ffb0f8bdefcacde1273ef6d1522364468082",
          "sha256:a94680665b5451874cb9a688966a05387da52c8e7b358685191bbcee9f9c3f36",
          "sha256:cafd6f1470e6d3b16cd504c736338be4244c280e4737610ec57b48913ba0bc5c",
          "sha256:3bb89949c252e55f7ab6ca332d6cfefdff58e93f21962004bc50b943a70aa084"
        ]
      },
      "config": {
        "Entrypoint": [
          "/usr/bin/fluentd"
        ],
        "Env": [
          "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
          "FLUENTD_CONF=/etc/fluent/fluent.conf",
          "LD_PRELOAD=",
          "SSL_CERT_FILE=/etc/ssl/certs/ca-certificates.crt"
        ],
        "Labels": {
          "Cleanstart.main.package": "ruby-fluentd-1.19",
          "org.opencontainers.image.authors": "Cleanstart Team https://www.cleanstart.com/",
          "org.opencontainers.image.licenses": "Apache-2.0",
          "org.opencontainers.image.vendor": "Cleanstart"
        },
        "User": "clnstrt"
      }
    },
    "Layers": [
      {
        "Size": 20440576,
        "DiffID": "sha256:a012dff9c6da8776fb1167dc6ffbc441528837d8ae79492efbb3708a25f87a58"
      },
      {
        "Size": 10240,
        "DiffID": "sha256:b508e54efc3e660e8edaf5f9516f7a6716753cb0641393d2778aad4b12f83da4"
      },
      {
        "Size": 245975552,
        "DiffID": "sha256:01b07146b35a0c3f5ae604860cb13b9aabae3cac057c189b6a5b17b55d7a9963"
      },
      {
        "Size": 2545664,
        "DiffID": "sha256:3a7356e31d5b2bfad704fb18a675b0a473869682a04014ad7783152b25067cd6"
      },
      {
        "Size": 4450816,
        "DiffID": "sha256:215292a875bb2fa642a9a3b411cf0f491913504a5df8657b45cf137c74efc30a"
      },
      {
        "Size": 5632,
        "DiffID": "sha256:daf0570f33ff19e58dc349c93591ffb0f8bdefcacde1273ef6d1522364468082"
      },
      {
        "Size": 189531648,
        "DiffID": "sha256:a94680665b5451874cb9a688966a05387da52c8e7b358685191bbcee9f9c3f36"
      },
      {
        "Size": 4608,
        "DiffID": "sha256:cafd6f1470e6d3b16cd504c736338be4244c280e4737610ec57b48913ba0bc5c"
      },
      {
        "Size": 7680,
        "DiffID": "sha256:3bb89949c252e55f7ab6ca332d6cfefdff58e93f21962004bc50b943a70aa084"
      }
    ]
  },
  "Results": [
    {
      "Target": "us-central1-docker.pkg.dev/ct2-staging-build/staging-hpe-images/fluentd-fips:1.19.0-dev (alpine 3.20.7)",
      "Class": "os-pkgs",
      "Type": "alpine"
    },
    {
      "Target": "Ruby",
      "Class": "lang-pkgs",
      "Type": "gemspec",
      "Vulnerabilities": [
        {
          "VulnerabilityID": "CVE-2025-61770",
          "PkgName": "rack",
          "PkgPath": "usr/lib/ruby/gems/3.3.0/specifications/rack-3.2.1.gemspec",
          "PkgIdentifier": {
            "PURL": "pkg:gem/rack@3.2.1",
            "UID": "2e52af966f1620af"
          },
          "InstalledVersion": "3.2.1",
          "FixedVersion": "~\u003e 2.2.19, ~\u003e 3.1.17, \u003e= 3.2.2",
          "Status": "fixed",
          "Layer": {
            "DiffID": "sha256:a94680665b5451874cb9a688966a05387da52c8e7b358685191bbcee9f9c3f36"
          },
          "SeveritySource": "ruby-advisory-db",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-61770",
          "DataSource": {
            "ID": "ruby-advisory-db",
            "Name": "Ruby Advisory Database",
            "URL": "https://github.com/rubysec/ruby-advisory-db"
          },
          "Title": "rack: Rack's unbounded multipart preamble buffering enables DoS (memory exhaustion)",
          "Description": "Rack is a modular Ruby web server interface. In versions prior to 2.2.19, 3.1.17, and 3.2.2, `Rack::Multipart::Parser` buffers the entire multipart preamble (bytes before the first boundary) in memory without any size limit. A client can send a large preamble followed by a valid boundary, causing significant memory use and potential process termination due to out-of-memory (OOM) conditions. Remote attackers can trigger large transient memory spikes by including a long preamble in multipart/form-data requests. The impact scales with allowed request sizes and concurrency, potentially causing worker crashes or severe slowdown due to garbage collection. Versions 2.2.19, 3.1.17, and 3.2.2 enforce a preamble size limit (e.g., 16 KiB) or discard preamble data entirely. Workarounds include limiting total request body size at the proxy or web server level and monitoring memory and set per-process limits to prevent OOM conditions.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-400"
          ],
          "VendorSeverity": {
            "amazon": 3,
            "ghsa": 3,
            "oracle-oval": 3,
            "redhat": 3,
            "ruby-advisory-db": 3
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-61770",
            "https://github.com/advisories/GHSA-p543-xpfm-54cp",
            "https://github.com/rack/rack",
            "https://github.com/rack/rack/commit/589127f4ac8b5cf11cf88fb0cd116ffed4d2181e",
            "https://github.com/rack/rack/commit/d869fed663b113b95a74ad53e1b5cae6ab31f29e",
            "https://github.com/rack/rack/commit/e08f78c656c9394d6737c022bde087e0f33336fd",
            "https://github.com/rack/rack/security/advisories/GHSA-p543-xpfm-54cp",
            "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2025-61770.yml",
            "https://linux.oracle.com/cve/CVE-2025-61770.html",
            "https://linux.oracle.com/errata/ELSA-2025-19719.html",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-61770",
            "https://www.cve.org/CVERecord?id=CVE-2025-61770"
          ],
          "PublishedDate": "2025-10-07T15:16:02.95Z",
          "LastModifiedDate": "2025-10-10T16:44:36.91Z"
        },
        {
          "VulnerabilityID": "CVE-2025-61771",
          "PkgName": "rack",
          "PkgPath": "usr/lib/ruby/gems/3.3.0/specifications/rack-3.2.1.gemspec",
          "PkgIdentifier": {
            "PURL": "pkg:gem/rack@3.2.1",
            "UID": "2e52af966f1620af"
          },
          "InstalledVersion": "3.2.1",
          "FixedVersion": "~\u003e 2.2.19, ~\u003e 3.1.17, \u003e= 3.2.2",
          "Status": "fixed",
          "Layer": {
            "DiffID": "sha256:a94680665b5451874cb9a688966a05387da52c8e7b358685191bbcee9f9c3f36"
          },
          "SeveritySource": "ruby-advisory-db",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-61771",
          "DataSource": {
            "ID": "ruby-advisory-db",
            "Name": "Ruby Advisory Database",
            "URL": "https://github.com/rubysec/ruby-advisory-db"
          },
          "Title": "rack: Rack's multipart parser buffers large non‑file fields entirely in memory, enabling DoS (memory exhaustion)",
          "Description": "Rack is a modular Ruby web server interface. In versions prior to 2.2.19, 3.1.17, and 3.2.2, ``Rack::Multipart::Parser` stores non-file form fields (parts without a `filename`) entirely in memory as Ruby `String` objects. A single large text field in a multipart/form-data request (hundreds of megabytes or more) can consume equivalent process memory, potentially leading to out-of-memory (OOM) conditions and denial of service (DoS). Attackers can send large non-file fields to trigger excessive memory usage. Impact scales with request size and concurrency, potentially leading to worker crashes or severe garbage-collection overhead. All Rack applications processing multipart form submissions are affected. Versions 2.2.19, 3.1.17, and 3.2.2 enforce a reasonable size cap for non-file fields (e.g., 2 MiB). Workarounds include restricting maximum request body size at the web-server or proxy layer (e.g., Nginx `client_max_body_size`) and validating and rejecting unusually large form fields at the application level.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-400"
          ],
          "VendorSeverity": {
            "amazon": 3,
            "ghsa": 3,
            "oracle-oval": 3,
            "redhat": 3,
            "ruby-advisory-db": 3
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-61771",
            "https://github.com/advisories/GHSA-w9pc-fmgc-vxvw",
            "https://github.com/rack/rack",
            "https://github.com/rack/rack/commit/589127f4ac8b5cf11cf88fb0cd116ffed4d2181e",
            "https://github.com/rack/rack/commit/d869fed663b113b95a74ad53e1b5cae6ab31f29e",
            "https://github.com/rack/rack/commit/e08f78c656c9394d6737c022bde087e0f33336fd",
            "https://github.com/rack/rack/security/advisories/GHSA-w9pc-fmgc-vxvw",
            "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2025-61771.yml",
            "https://linux.oracle.com/cve/CVE-2025-61771.html",
            "https://linux.oracle.com/errata/ELSA-2025-19719.html",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-61771",
            "https://www.cve.org/CVERecord?id=CVE-2025-61771"
          ],
          "PublishedDate": "2025-10-07T15:16:03.123Z",
          "LastModifiedDate": "2025-10-10T16:45:09.96Z"
        },
        {
          "VulnerabilityID": "CVE-2025-61772",
          "PkgName": "rack",
          "PkgPath": "usr/lib/ruby/gems/3.3.0/specifications/rack-3.2.1.gemspec",
          "PkgIdentifier": {
            "PURL": "pkg:gem/rack@3.2.1",
            "UID": "2e52af966f1620af"
          },
          "InstalledVersion": "3.2.1",
          "FixedVersion": "~\u003e 2.2.19, ~\u003e 3.1.17, \u003e= 3.2.2",
          "Status": "fixed",
          "Layer": {
            "DiffID": "sha256:a94680665b5451874cb9a688966a05387da52c8e7b358685191bbcee9f9c3f36"
          },
          "SeveritySource": "ruby-advisory-db",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-61772",
          "DataSource": {
            "ID": "ruby-advisory-db",
            "Name": "Ruby Advisory Database",
            "URL": "https://github.com/rubysec/ruby-advisory-db"
          },
          "Title": "rack: Rack memory exhaustion denial of service",
          "Description": "Rack is a modular Ruby web server interface. In versions prior to 2.2.19, 3.1.17, and 3.2.2, `Rack::Multipart::Parser` can accumulate unbounded data when a multipart part’s header block never terminates with the required blank line (`CRLFCRLF`). The parser keeps appending incoming bytes to memory without a size cap, allowing a remote attacker to exhaust memory and cause a denial of service (DoS). Attackers can send incomplete multipart headers to trigger high memory use, leading to process termination (OOM) or severe slowdown. The effect scales with request size limits and concurrency. All applications handling multipart uploads may be affected. Versions 2.2.19, 3.1.17, and 3.2.2 cap per-part header size (e.g., 64 KiB). As a workaround, restrict maximum request sizes at the proxy or web server layer (e.g., Nginx `client_max_body_size`).",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-400"
          ],
          "VendorSeverity": {
            "amazon": 3,
            "ghsa": 3,
            "oracle-oval": 3,
            "redhat": 2,
            "ruby-advisory-db": 3
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
              "V3Score": 5.3
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-61772",
            "https://github.com/advisories/GHSA-wpv5-97wm-hp9c",
            "https://github.com/rack/rack",
            "https://github.com/rack/rack/commit/589127f4ac8b5cf11cf88fb0cd116ffed4d2181e",
            "https://github.com/rack/rack/commit/d869fed663b113b95a74ad53e1b5cae6ab31f29e",
            "https://github.com/rack/rack/commit/e08f78c656c9394d6737c022bde087e0f33336fd",
            "https://github.com/rack/rack/security/advisories/GHSA-wpv5-97wm-hp9c",
            "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2025-61772.yml",
            "https://linux.oracle.com/cve/CVE-2025-61772.html",
            "https://linux.oracle.com/errata/ELSA-2025-19719.html",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-61772",
            "https://www.cve.org/CVERecord?id=CVE-2025-61772"
          ],
          "PublishedDate": "2025-10-07T15:16:03.28Z",
          "LastModifiedDate": "2025-10-10T16:45:29.133Z"
        },
        {
          "VulnerabilityID": "CVE-2025-61919",
          "PkgName": "rack",
          "PkgPath": "usr/lib/ruby/gems/3.3.0/specifications/rack-3.2.1.gemspec",
          "PkgIdentifier": {
            "PURL": "pkg:gem/rack@3.2.1",
            "UID": "2e52af966f1620af"
          },
          "InstalledVersion": "3.2.1",
          "FixedVersion": "~\u003e 2.2.20, ~\u003e 3.1.18, \u003e= 3.2.3",
          "Status": "fixed",
          "Layer": {
            "DiffID": "sha256:a94680665b5451874cb9a688966a05387da52c8e7b358685191bbcee9f9c3f36"
          },
          "SeveritySource": "ruby-advisory-db",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-61919",
          "DataSource": {
            "ID": "ruby-advisory-db",
            "Name": "Ruby Advisory Database",
            "URL": "https://github.com/rubysec/ruby-advisory-db"
          },
          "Title": "rubygem-rack: Unbounded read in `Rack::Request` form parsing can lead to memory exhaustion",
          "Description": "Rack is a modular Ruby web server interface. Prior to versions 2.2.20, 3.1.18, and 3.2.3, `Rack::Request#POST` reads the entire request body into memory for `Content-Type: application/x-www-form-urlencoded`, calling `rack.input.read(nil)` without enforcing a length or cap. Large request bodies can therefore be buffered completely into process memory before parsing, leading to denial of service (DoS) through memory exhaustion. Users should upgrade to Rack version 2.2.20, 3.1.18, or 3.2.3, anu of which enforces form parameter limits using `query_parser.bytesize_limit`, preventing unbounded reads of `application/x-www-form-urlencoded` bodies. Additionally, enforce strict maximum body size at the proxy or web server layer (e.g., Nginx `client_max_body_size`, Apache `LimitRequestBody`).",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-400"
          ],
          "VendorSeverity": {
            "ghsa": 3,
            "oracle-oval": 3,
            "redhat": 3,
            "ruby-advisory-db": 3
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "V3Score": 7.5
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-61919",
            "https://github.com/advisories/GHSA-6xw4-3v39-52mm",
            "https://github.com/rack/rack",
            "https://github.com/rack/rack/commit/4e2c903991a790ee211a3021808ff4fd6fe82881",
            "https://github.com/rack/rack/commit/cbd541e8a3d0c5830a3c9a30d3718ce2e124f9db",
            "https://github.com/rack/rack/commit/e179614c4a653283286f5f046428cbb85f21146f",
            "https://github.com/rack/rack/security/advisories/GHSA-6xw4-3v39-52mm",
            "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2025-61919.yml",
            "https://linux.oracle.com/cve/CVE-2025-61919.html",
            "https://linux.oracle.com/errata/ELSA-2025-19719.html",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-61919",
            "https://www.cve.org/CVERecord?id=CVE-2025-61919"
          ],
          "PublishedDate": "2025-10-10T20:15:37.73Z",
          "LastModifiedDate": "2025-11-03T19:28:04.42Z"
        },
        {
          "VulnerabilityID": "CVE-2025-61780",
          "PkgName": "rack",
          "PkgPath": "usr/lib/ruby/gems/3.3.0/specifications/rack-3.2.1.gemspec",
          "PkgIdentifier": {
            "PURL": "pkg:gem/rack@3.2.1",
            "UID": "2e52af966f1620af"
          },
          "InstalledVersion": "3.2.1",
          "FixedVersion": "~\u003e 2.2.20, ~\u003e 3.1.18, \u003e= 3.2.3",
          "Status": "fixed",
          "Layer": {
            "DiffID": "sha256:a94680665b5451874cb9a688966a05387da52c8e7b358685191bbcee9f9c3f36"
          },
          "SeveritySource": "ruby-advisory-db",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-61780",
          "DataSource": {
            "ID": "ruby-advisory-db",
            "Name": "Ruby Advisory Database",
            "URL": "https://github.com/rubysec/ruby-advisory-db"
          },
          "Title": "rubygem-rack: Improper handling of headers in `Rack::Sendfile` may allow proxy bypass",
          "Description": "Rack is a modular Ruby web server interface. Prior to versions 2.2.20, 3.1.18, and 3.2.3, a possible information disclosure vulnerability existed in `Rack::Sendfile` when running behind a proxy that supports `x-sendfile` headers (such as Nginx). Specially crafted headers could cause `Rack::Sendfile` to miscommunicate with the proxy and trigger unintended internal requests, potentially bypassing proxy-level access restrictions. When `Rack::Sendfile` received untrusted `x-sendfile-type` or `x-accel-mapping` headers from a client, it would interpret them as proxy configuration directives. This could cause the middleware to send a \"redirect\" response to the proxy, prompting it to reissue a new internal request that was not subject to the proxy's access controls. An attacker could exploit this by setting a crafted `x-sendfile-type: x-accel-redirect` header, setting a crafted `x-accel-mapping` header, and requesting a path that qualifies for proxy-based acceleration. Attackers could bypass proxy-enforced restrictions and access internal endpoints intended to be protected (such as administrative pages). The vulnerability did not allow arbitrary file reads but could expose sensitive application routes. This issue only affected systems meeting all of the following conditions: The application used `Rack::Sendfile` with a proxy that supports `x-accel-redirect` (e.g., Nginx); the proxy did **not** always set or remove the `x-sendfile-type` and `x-accel-mapping` headers; and the application exposed an endpoint that returned a body responding to `.to_path`. Users should upgrade to Rack versions 2.2.20, 3.1.18, or 3.2.3, which require explicit configuration to enable `x-accel-redirect`. Alternatively, configure the proxy to always set or strip the header, or in Rails applications, disable sendfile completely.",
          "Severity": "MEDIUM",
          "CweIDs": [
            "CWE-200",
            "CWE-441",
            "CWE-913"
          ],
          "VendorSeverity": {
            "ghsa": 2,
            "nvd": 2,
            "redhat": 2,
            "ruby-advisory-db": 2
          },
          "CVSS": {
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N",
              "V3Score": 5.8
            },
            "nvd": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
              "V3Score": 5.3
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N",
              "V3Score": 5.8
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2025-61780",
            "https://github.com/advisories/GHSA-r657-rxjc-j557",
            "https://github.com/rack/rack",
            "https://github.com/rack/rack/commit/57277b7741581fa827472c5c666f6e6a33abd784",
            "https://github.com/rack/rack/commit/7e69f65eefe9cd2868df9f9f3b0977b86f93523a",
            "https://github.com/rack/rack/commit/fba2c8bc63eb787ff4b19bc612d315fda6126d85",
            "https://github.com/rack/rack/security/advisories/GHSA-r657-rxjc-j557",
            "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack/CVE-2025-61780.yml",
            "https://nvd.nist.gov/vuln/detail/CVE-2025-61780",
            "https://www.cve.org/CVERecord?id=CVE-2025-61780"
          ],
          "PublishedDate": "2025-10-10T17:15:39.557Z",
          "LastModifiedDate": "2025-10-30T14:24:43.13Z"
        },
        {
          "VulnerabilityID": "CVE-2025-61594",
          "PkgName": "uri",
          "PkgPath": "usr/lib/ruby/gems/3.3.0/specifications/default/uri-0.13.2.gemspec",
          "PkgIdentifier": {
            "PURL": "pkg:gem/uri@0.13.2",
            "UID": "7616c2b47587ce5d"
          },
          "InstalledVersion": "0.13.2",
          "FixedVersion": "~\u003e 0.12.5, ~\u003e 0.13.3, \u003e= 1.0.4",
          "Status": "fixed",
          "Layer": {
            "DiffID": "sha256:a94680665b5451874cb9a688966a05387da52c8e7b358685191bbcee9f9c3f36"
          },
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-61594",
          "DataSource": {
            "ID": "ruby-advisory-db",
            "Name": "Ruby Advisory Database",
            "URL": "https://github.com/rubysec/ruby-advisory-db"
          },
          "Title": "CVE-2025-61594 - URI Credential Leakage Bypass over CVE-2025-27221",
          "Description": "\nIn affected URI version, a bypass exists for the fix to CVE-2025-27221\nthat can expose user credentials.\n\nThis vulnerability has been assigned the CVE identifier CVE-2025-61594.\nWe recommend upgrading the uri gem.\n\n## Details\n\nWhen using the + operator to combine URIs, sensitive information\nlike passwords from the original URI can be leaked, violating\nRFC3986 and making applications vulnerable to credential exposure.\n\nPlease update URI gem to version 0.12.5, 0.13.3, 1.0.4 or later.\n\n## Affected versions\n\nuri gem versions \u003c 0.12.5, 0.13.0 to 0.13.2 and 1.0.0 to 1.0.3.\n\n## Credits\n\nThanks to junfuchong (chongfujun) for discovering this issue.\nAlso thanks to nobu for additional fixes of this vulnerability.\n",
          "Severity": "UNKNOWN",
          "References": [
            "https://github.com/ruby/uri",
            "https://rubygems.org/gems/uri/versions/0.12.5",
            "https://rubygems.org/gems/uri/versions/0.13.3",
            "https://rubygems.org/gems/uri/versions/1.0.4",
            "https://www.ruby-lang.org/en/news/2025/10/07/uri-cve-2025-61594"
          ]
        },
        {
          "VulnerabilityID": "CVE-2025-61594",
          "PkgName": "uri",
          "PkgPath": "usr/lib/ruby/gems/3.3.0/specifications/uri-1.0.3.gemspec",
          "PkgIdentifier": {
            "PURL": "pkg:gem/uri@1.0.3",
            "UID": "1d72a000fbb02d4b"
          },
          "InstalledVersion": "1.0.3",
          "FixedVersion": "~\u003e 0.12.5, ~\u003e 0.13.3, \u003e= 1.0.4",
          "Status": "fixed",
          "Layer": {
            "DiffID": "sha256:a94680665b5451874cb9a688966a05387da52c8e7b358685191bbcee9f9c3f36"
          },
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2025-61594",
          "DataSource": {
            "ID": "ruby-advisory-db",
            "Name": "Ruby Advisory Database",
            "URL": "https://github.com/rubysec/ruby-advisory-db"
          },
          "Title": "CVE-2025-61594 - URI Credential Leakage Bypass over CVE-2025-27221",
          "Description": "\nIn affected URI version, a bypass exists for the fix to CVE-2025-27221\nthat can expose user credentials.\n\nThis vulnerability has been assigned the CVE identifier CVE-2025-61594.\nWe recommend upgrading the uri gem.\n\n## Details\n\nWhen using the + operator to combine URIs, sensitive information\nlike passwords from the original URI can be leaked, violating\nRFC3986 and making applications vulnerable to credential exposure.\n\nPlease update URI gem to version 0.12.5, 0.13.3, 1.0.4 or later.\n\n## Affected versions\n\nuri gem versions \u003c 0.12.5, 0.13.0 to 0.13.2 and 1.0.0 to 1.0.3.\n\n## Credits\n\nThanks to junfuchong (chongfujun) for discovering this issue.\nAlso thanks to nobu for additional fixes of this vulnerability.\n",
          "Severity": "UNKNOWN",
          "References": [
            "https://github.com/ruby/uri",
            "https://rubygems.org/gems/uri/versions/0.12.5",
            "https://rubygems.org/gems/uri/versions/0.13.3",
            "https://rubygems.org/gems/uri/versions/1.0.4",
            "https://www.ruby-lang.org/en/news/2025/10/07/uri-cve-2025-61594"
          ]
        }
      ]
    }
  ]
}
