{"ast":null,"code":"// Helper: Parse metadata from folder, filename\n// Parse image name and version, allowing for suffixes: \"argo-cli-fips-3.4.18-dev-27-10-2025.json\"\nexport function parseImageMeta(folder, filename) {\n  // Remove .json\n  const naked = filename.replace(/\\.json$/i, \"\");\n  // Remove date at end (-d-d-d or -dd-mm-yyyy)\n  const dateMatch = /-(\\d{1,2}-\\d{1,2}-\\d{4})$/.exec(naked);\n  let main = naked;\n  if (dateMatch) main = naked.slice(0, -dateMatch[0].length);\n\n  // Match any version with 2-4 numeric segments: 1.2, 1.2.3, 1.2.3.4\n  // Optionally with channel (-dev, -prod, etc) as part of version\n  const verMatch = /-(\\d+\\.\\d+(?:\\.\\d+){0,2}(?:-[a-zA-Z0-9]+)?)$/.exec(main);\n  let image = main,\n    version = \"\";\n  if (verMatch) {\n    version = verMatch[1];\n    image = main.slice(0, -verMatch[0].length);\n  }\n  return {\n    image,\n    version,\n    file: filename,\n    folder\n  };\n}\n\n// Recursively build path tree from image keys like batch-2/ct2-stage/xyz/imageA\nexport function buildPathTree(data) {\n  const tree = {};\n  Object.keys(data).forEach(k => {\n    const parts = k.split(/[\\\\/]/);\n    let node = tree;\n    parts.forEach(part => {\n      if (!node[part]) node[part] = {};\n      node = node[part];\n    });\n  });\n  return tree;\n}\n\n// Aggregate stats in a directory subtree\nexport function aggregateDir(data, dir) {\n  let images = [],\n    cves = 0;\n  Object.entries(data).forEach(([path, files]) => {\n    if (path.startsWith(dir)) {\n      images.push(path);\n      for (const v of Object.values(files)) {\n        if (!v || v.status === \"No scan result\") continue;\n        if (typeof v === \"object\" && Object.keys(v).length > 0) cves += Object.keys(v).length;\n      }\n    }\n  });\n  return {\n    images,\n    cves\n  };\n}\nexport function compareVulnData(curr, prev) {\n  // Returns {added: { [image]: {file: {cve: vulnObj}}}}\n  const added = {};\n  for (const [img, currFiles] of Object.entries(curr)) {\n    const prevFiles = prev[img] || {};\n    for (const [file, currVulns] of Object.entries(currFiles)) {\n      const prevVulns = prevFiles[file] || {};\n      if (typeof currVulns === \"object\" && !Array.isArray(currVulns) && Object.keys(currVulns).length > 0) {\n        for (const cve of Object.keys(currVulns)) {\n          if (!(cve in prevVulns)) {\n            if (!added[img]) added[img] = {};\n            if (!added[img][file]) added[img][file] = {};\n            added[img][file][cve] = currVulns[cve];\n          }\n        }\n      }\n    }\n  }\n  return added;\n}","map":{"version":3,"names":["parseImageMeta","folder","filename","naked","replace","dateMatch","exec","main","slice","length","verMatch","image","version","file","buildPathTree","data","tree","Object","keys","forEach","k","parts","split","node","part","aggregateDir","dir","images","cves","entries","path","files","startsWith","push","v","values","status","compareVulnData","curr","prev","added","img","currFiles","prevFiles","currVulns","prevVulns","Array","isArray","cve"],"sources":["/home/raghav/schema-data/cleanstart-security-advisories/dashboard/frontend/src/helpers.js"],"sourcesContent":["// Helper: Parse metadata from folder, filename\n// Parse image name and version, allowing for suffixes: \"argo-cli-fips-3.4.18-dev-27-10-2025.json\"\nexport function parseImageMeta(folder, filename) {\n  // Remove .json\n  const naked = filename.replace(/\\.json$/i, \"\");\n  // Remove date at end (-d-d-d or -dd-mm-yyyy)\n  const dateMatch = /-(\\d{1,2}-\\d{1,2}-\\d{4})$/.exec(naked);\n  let main = naked;\n  if (dateMatch) main = naked.slice(0, -dateMatch[0].length);\n\n  // Match any version with 2-4 numeric segments: 1.2, 1.2.3, 1.2.3.4\n  // Optionally with channel (-dev, -prod, etc) as part of version\n  const verMatch = /-(\\d+\\.\\d+(?:\\.\\d+){0,2}(?:-[a-zA-Z0-9]+)?)$/.exec(main);\n  let image = main, version = \"\";\n  if (verMatch) {\n    version = verMatch[1];\n    image = main.slice(0, -verMatch[0].length);\n  }\n  return { image, version, file: filename, folder };\n}\n\n// Recursively build path tree from image keys like batch-2/ct2-stage/xyz/imageA\nexport function buildPathTree(data) {\n  const tree = {};\n  Object.keys(data).forEach(k => {\n    const parts = k.split(/[\\\\/]/);\n    let node = tree;\n    parts.forEach(part => {\n      if (!node[part]) node[part] = {};\n      node = node[part];\n    });\n  });\n  return tree;\n}\n\n// Aggregate stats in a directory subtree\nexport function aggregateDir(data, dir) {\n  let images = [], cves = 0;\n  Object.entries(data).forEach(([path, files]) => {\n    if (path.startsWith(dir)) {\n      images.push(path);\n      for (const v of Object.values(files)) {\n        if (!v || v.status === \"No scan result\") continue;\n        if (typeof v === \"object\" && Object.keys(v).length > 0) cves += Object.keys(v).length;\n      }\n    }\n  });\n  return { images, cves };\n}\n\nexport function compareVulnData(curr, prev) {\n  // Returns {added: { [image]: {file: {cve: vulnObj}}}}\n  const added = {};\n  for (const [img, currFiles] of Object.entries(curr)) {\n    const prevFiles = prev[img] || {};\n    for (const [file, currVulns] of Object.entries(currFiles)) {\n      const prevVulns = prevFiles[file] || {};\n      if (typeof currVulns === \"object\" && !Array.isArray(currVulns) && Object.keys(currVulns).length > 0) {\n        for (const cve of Object.keys(currVulns)) {\n          if (!(cve in prevVulns)) {\n            if (!added[img]) added[img] = {};\n            if (!added[img][file]) added[img][file] = {};\n            added[img][file][cve] = currVulns[cve];\n          }\n        }\n      }\n    }\n  }\n  return added;\n}\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}