{"ast":null,"code":"var _jsxFileName = \"/home/raghav/schema-data/cleanstart-security-advisories/dashboard/frontend/src/TopStats.jsx\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction getStats(data) {\n  let merged = {};\n  // Merge folders if data is nested by folder\n  if (typeof Object.values(data)[0] === \"object\" && !Array.isArray(Object.values(data)[0])) {\n    for (const folder of Object.values(data)) {\n      Object.assign(merged, folder);\n    }\n  } else {\n    merged = data;\n  }\n  let totalImages = Object.keys(merged).length;\n  let vulnerableImages = 0;\n  let cves = 0;\n  let acknowledged = 0;\n  let unacknowledged = 0;\n  Object.entries(merged).forEach(([image, cveMap]) => {\n    const cveList = Object.entries(cveMap || {});\n    if (cveList.some(([cve, v]) => (v.status || v.Status) !== \"No Vulnerabilities\" && (v.status || v.Status || \"\").toLowerCase() !== \"fixed\")) {\n      vulnerableImages++;\n    }\n    cves += cveList.filter(([cve, v]) => cve !== \"NO_CVE\").length;\n    for (const [, v] of cveList) {\n      if (!v) continue;\n      if ((v.status || v.Status) && (v.status || v.Status) !== \"UnderInvestigation\" && (v.status || v.Status) !== \"No Vulnerabilities\") {\n        acknowledged++;\n      } else if ((v.status || v.Status) !== \"No Vulnerabilities\") {\n        unacknowledged++;\n      }\n    }\n  });\n  return {\n    totalImages,\n    vulnerableImages,\n    cves,\n    acknowledged,\n    unacknowledged\n  };\n}\nfunction TopStats({\n  data,\n  dirName,\n  imageCount\n}) {\n  const {\n    totalImages,\n    vulnerableImages,\n    cves,\n    acknowledged,\n    unacknowledged\n  } = getStats(data);\n  const statStyle = {\n    background: \"#232854\",\n    color: \"#fff\",\n    borderRadius: 9,\n    margin: \"0 15px 0 0\",\n    padding: \"14px 28px\",\n    display: \"inline-block\",\n    minWidth: 95,\n    fontWeight: 600\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginBottom: 12\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 9,\n        color: \"#5ec7fa\",\n        fontWeight: 600,\n        fontSize: \"1.15rem\"\n      },\n      children: [dirName, \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          color: \"#bbb\",\n          fontSize: \".95em\",\n          fontWeight: 500\n        },\n        children: [\"(Images: \", totalImages, \" | CVEs: \", cves, \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 19\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      style: statStyle,\n      children: [\"Images: \", totalImages]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      style: {\n        ...statStyle,\n        background: \"#a71a1a\"\n      },\n      children: [\"Vulnerable: \", vulnerableImages]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      style: {\n        ...statStyle,\n        background: \"#5a5b83\"\n      },\n      children: [\"Total CVEs: \", cves]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      style: {\n        ...statStyle,\n        background: \"#11689f\"\n      },\n      children: [\"Acknowledged: \", acknowledged]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      style: {\n        ...statStyle,\n        background: \"#aa4308ff\"\n      },\n      children: [\"Unacked: \", unacknowledged]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 41,\n    columnNumber: 5\n  }, this);\n}\n_c = TopStats;\nexport default TopStats;\nvar _c;\n$RefreshReg$(_c, \"TopStats\");","map":{"version":3,"names":["getStats","data","merged","Object","values","Array","isArray","folder","assign","totalImages","keys","length","vulnerableImages","cves","acknowledged","unacknowledged","entries","forEach","image","cveMap","cveList","some","cve","v","status","Status","toLowerCase","filter","TopStats","dirName","imageCount","statStyle","background","color","borderRadius","margin","padding","display","minWidth","fontWeight","_jsxDEV","style","marginBottom","children","fontSize","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/raghav/schema-data/cleanstart-security-advisories/dashboard/frontend/src/TopStats.jsx"],"sourcesContent":["function getStats(data) {\n  let merged = {};\n  // Merge folders if data is nested by folder\n  if (typeof Object.values(data)[0] === \"object\" && !Array.isArray(Object.values(data)[0])) {\n    for (const folder of Object.values(data)) {\n      Object.assign(merged, folder);\n    }\n  } else {\n    merged = data;\n  }\n\n  let totalImages = Object.keys(merged).length;\n  let vulnerableImages = 0;\n  let cves = 0;\n  let acknowledged = 0;\n  let unacknowledged = 0;\n\n  Object.entries(merged).forEach(([image, cveMap]) => {\n    const cveList = Object.entries(cveMap || {});\n    if (cveList.some(([cve, v]) => (v.status || v.Status) !== \"No Vulnerabilities\" && (v.status || v.Status || \"\").toLowerCase() !== \"fixed\")) {\n      vulnerableImages++;\n    }\n    cves += cveList.filter(([cve, v]) => cve !== \"NO_CVE\").length;\n    for (const [, v] of cveList) {\n      if (!v) continue;\n      if ((v.status || v.Status) && (v.status || v.Status) !== \"UnderInvestigation\" && (v.status || v.Status) !== \"No Vulnerabilities\") {\n        acknowledged++;\n      } else if ((v.status || v.Status) !== \"No Vulnerabilities\") {\n        unacknowledged++;\n      }\n    }\n  });\n\n  return { totalImages, vulnerableImages, cves, acknowledged, unacknowledged };\n}\n\nfunction TopStats({ data, dirName, imageCount }) {\n  const { totalImages, vulnerableImages, cves, acknowledged, unacknowledged } = getStats(data);\n  const statStyle = { background: \"#232854\", color: \"#fff\", borderRadius: 9, margin: \"0 15px 0 0\", padding: \"14px 28px\", display: \"inline-block\", minWidth: 95, fontWeight: 600 };\n  return (\n    <div style={{ marginBottom: 12 }}>\n      <div style={{ marginBottom: 9, color: \"#5ec7fa\", fontWeight: 600, fontSize: \"1.15rem\" }}>\n        {dirName} <span style={{ color: \"#bbb\", fontSize: \".95em\", fontWeight: 500 }}>(Images: {totalImages} | CVEs: {cves})</span>\n      </div>\n      <span style={statStyle}>Images: {totalImages}</span>\n      <span style={{ ...statStyle, background: \"#a71a1a\" }}>Vulnerable: {vulnerableImages}</span>\n      <span style={{ ...statStyle, background: \"#5a5b83\" }}>Total CVEs: {cves}</span>\n      <span style={{ ...statStyle, background: \"#11689f\" }}>Acknowledged: {acknowledged}</span>\n      <span style={{ ...statStyle, background: \"#aa4308ff\" }}>Unacked: {unacknowledged}</span>\n    </div>\n  );\n}\n\nexport default TopStats;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}